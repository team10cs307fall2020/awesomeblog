<% @user = User.find_by(:username => @post.author) %>
<% if @user.id != current_user.id and Block.exists?(:user_id => @user.id, :name => current_user.username, :category => "User") %>
  <h3>Sorry, seems that you have been blocked by this user, try to be nice!</h3>
  <form>
    <input type="button" value="Go Back" onclick="history.go(-1)">
  </form>
<% else %>

  <% @temp = Topic.where(:title => @post.topic) %>
  <% @post.comments.each do |comment| %>

    <p>
      <strong>Topic:</strong>
      <%= link_to @post.topic, topic_path(@temp.pluck(:id)[0]) %>
    </p>
    <p>
      <strong>Title:</strong>
      <%= @post.title %>
    </p>

    <p>
      <strong>Text:</strong>
      <%= @post.text %>
    </p>

    <p>
      <strong>Privacy:</strong>
      <%= @post.privacy %>
      <%if @post.privacy == nil %>
      <%="Everyone"%>
      <%end %>
    </p>


    <p>
      <%= raw Rinku.auto_link(@post.text, mode = :all) %>
    </p>

  <% end %>

  <p>
    <strong>Posted by:</strong>

    <% if @post.anonymous == 1 %>
    <td>Anonymous</td>
  <% else @user = User.find_by(username: @post.author)%>
    <%= link_to @user.username, view_user_path(@user) %>
  <% end %>
  </p>

<p>
  Likes: <%= @post.get_upvotes.size %>
  Dislikes: <%= @post.get_downvotes.size %>
  <%= link_to 'UpVote', upvote_path(:id => @post.id) %>
  <%= link_to 'DownVote', downvote_path(:id => @post.id) %>
</p>


<% if @post.picture.attached? %>
  <img src="<%=(url_for(@post.picture))%>"
  height="500"
  alt="can not found image">
  <% end %>

<% @post.comments.each do |comment| %>
  <p>
    <strong>Commenter:</strong>
    <%= comment.commenter %>
  </p>

  <p>
    <strong>Comment:</strong>
    <%= comment.body %>
  </p>
<% end %> -->

<h2>Comments</h2>
  <%= render @post.comments %>

  <h2>Add a comment:</h2>
  <%= render 'comments/form' %>


  <%= link_to 'Edit', edit_post_path(@post) %> |
  <%= link_to 'Back', posts_path %>

<% end %>
